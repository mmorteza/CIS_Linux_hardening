# Generated by Ansible - INPUT rules for firewalld
{% for rule in input_rules %}
{% if 'tcp dport' in rule %}
rule family="ipv4" port port="{{ rule.split('dport')[1].split()[0] }}" protocol="tcp" accept
{% elif 'udp dport' in rule %}
rule family="ipv4" port port="{{ rule.split('dport')[1].split()[0] }}" protocol="udp" accept
{% elif 'ip saddr' in rule and 'drop' in rule %}
rule family="ipv4" source address="{{ rule.split('ip saddr')[1].split()[0] }}" drop
{% elif 'icmp' in rule %}
rule family="ipv4" protocol="icmp" accept
{% elif 'icmpv6' in rule %}
rule family="ipv6" protocol="ipv6-icmp" accept
{% elif 'log' in rule %}
rule log prefix="firewalld-input" level="info" drop
{% elif 'accept' in rule %}
rule accept
{% elif 'drop' in rule %}
rule drop
{% else %}
# unknown rule: {{ rule }}
{% endif %}
{% endfor %}
